<!DOCTYPE html><html lang="fa" dir="rtl"><head>    <meta charset="UTF-8">    <meta name="viewport" content="width=device-width, initial-scale=1.0">    <title>میزان کارکرد کارکنان اورژانس</title>    <script src="https://html2canvas.hertzen.com/dist/html2canvas.min.js"></script>    <style>        @import url('https://fonts.googleapis.com/css2?family=Vazirmatn:wght@400;700&display=swap');        :root {            --primary-color: #4CAF50;            --secondary-color: #45a049;            --background-color: #f0f0f0;            --container-bg: #ffffff;            --text-color: #333333;            --border-color: #dddddd;        }        body {            font-family: 'Vazirmatn', 'Tahoma', sans-serif;            background-color: var(--background-color);            margin: 0;            padding: 20px;            color: var(--text-color);            line-height: 1.6;        }        .container {            max-width: 1000px;            margin: 0 auto;            background-color: var(--container-bg);            padding: 30px;            border-radius: 12px;            box-shadow: 0 10px 30px rgba(0,0,0,0.1);        }        h1, h2 {            color: var(--primary-color);            margin-bottom: 20px;        }        .section {            margin-bottom: 30px;            padding: 20px;            background-color: #f9f9f9;            border-radius: 8px;            box-shadow: 0 4px 6px rgba(0,0,0,0.05);        }        label {            display: block;            margin-bottom: 8px;            font-weight: bold;        }        input, select {            width: 100%;            padding: 10px;            margin-bottom: 15px;            border: 1px solid var(--border-color);            border-radius: 6px;            font-size: 16px;        }        button {            background-color: var(--primary-color);            color: white;            padding: 12px 20px;            border: none;            border-radius: 6px;            cursor: pointer;            font-size: 16px;            transition: background-color 0.3s ease;        }        button:hover {            background-color: var(--secondary-color);        }        table {            width: 100%;            border-collapse: collapse;            margin-top: 20px;            box-shadow: 0 4px 6px rgba(0,0,0,0.05);        }        th, td {            border: 1px solid var(--border-color);            padding: 12px;            text-align: right;        }        th {            background-color: var(--primary-color);            color: white;        }        @media (max-width: 768px) {            .container {                padding: 15px;            }            input, select {                font-size: 14px;            }            button {                width: 100%;                margin-bottom: 10px;            }            table {                font-size: 14px;            }        }    </style></head><body>    <div class="container">        <h1>میزان کارکرد کارکنان اورژانس</h1>                <div class="section">            <h2>اطلاعات پایگاه</h2>            <label for="baseName">نام پایگاه:</label>            <select id="baseName">                <option value="فلسطین">فلسطین</option>                <option value="فرهنگ">فرهنگ</option>                <option value="اسماعیلی">اسماعیلی</option>                <option value="راهبند عاشقان">راهبند عاشقان</option>                <option value="راهبند آهی دشت">راهبند آهی دشت</option>                <option value="وفاییان">وفاییان</option>                <option value="پیامبر اعظم">پیامبر اعظم</option>                <option value="شجاع">شجاع</option>                <option value="تاکام">تاکام</option>                <option value="محمد آباد">محمد آباد</option>                <option value="کلاج خوسه">کلاج خوسه</option>                <option value="کیاسر">کیاسر</option>                <option value="تلمادره">تلمادره</option>                <option value="فرودگاه">فرودگاه</option>            </select>            <label for="baseType">نوع پایگاه:</label>            <select id="baseType">                <option value="شهری">شهری</option>                <option value="جاده ای">جاده ای</option>            </select>            <label for="monthYear">ماه و سال:</label>            <input type="text" id="monthYear" placeholder="مثلا : خرداد ۱۴۰۳">        </div>        <div class="section">            <h2>اطلاعات پرسنل</h2>            <label for="personnelName">نام پرسنل:</label>            <input type="text" id="personnelName">            <label for="isProductive">بهره ور:</label>            <input type="checkbox" id="isProductive">        </div>        <div class="section">            <h2>شیفت ها</h2>            <div id="shifts">                <!-- Shift inputs will be dynamically added here -->            </div>        </div>        <div class="section">            <h2>موارد تکمیلی</h2>            <div id="additionalItems">                <!-- Additional items will be dynamically added here -->            </div>            <label for="missionCount">تعداد ماموریت:</label>            <input type="number" id="missionCount">            <label for="mealCount">تعداد وعده غذا:</label>            <input type="number" id="mealCount">            <label for="notes">ملاحظات:</label>            <input type="text" id="notes">        </div>        <button id="submitBtn">ثبت</button>        <button id="updateBtn" style="display: none;">به روز رسانی</button>        <div id="tableContainer"></div>    </div>    <script>        const shifts = [            { label: 'شیفت ۲۴ عادی', countId: 'shift24Normal', dateId: 'shift24NormalDate' },            { label: 'شیفت ۲۴ تعطیل', countId: 'shift24Holiday', dateId: 'shift24HolidayDate' },            { label: 'شیفت لانگ عادی', countId: 'shiftLongNormal', dateId: 'shiftLongNormalDate' },            { label: 'شیفت لانگ تعطیل', countId: 'shiftLongHoliday', dateId: 'shiftLongHolidayDate' },            { label: 'شیفت شب', countId: 'shiftNight', dateId: 'shiftNightDate' },            { label: 'مرخصی کامل', countId: 'fullLeave', dateId: 'fullLeaveDate' }        ];        const additionalItems = [            { label: 'ساعات متفرقه', hoursId: 'miscHours', dateId: 'miscHoursDate' },            { label: 'مرخصی ساعتی', hoursId: 'hourlyLeave', dateId: 'hourlyLeaveDate' }        ];        function createShiftInputs() {            const shiftsContainer = document.getElementById('shifts');            shifts.forEach(shift => {                const shiftDiv = document.createElement('div');                shiftDiv.innerHTML = `                    <label>${shift.label}:</label>                    <input type="number" id="${shift.countId}" placeholder="تعداد">                    <input type="text" id="${shift.dateId}" placeholder="تاریخ">                `;                shiftsContainer.appendChild(shiftDiv);            });        }        function createAdditionalItemInputs() {            const additionalItemsContainer = document.getElementById('additionalItems');            additionalItems.forEach(item => {                const itemDiv = document.createElement('div');                itemDiv.innerHTML = `                    <label>${item.label}:</label>                    <input type="number" id="${item.hoursId}" placeholder="میزان به ساعت">                    <input type="text" id="${item.dateId}" placeholder="تاریخ">                `;                additionalItemsContainer.appendChild(itemDiv);            });        }        createShiftInputs();        createAdditionalItemInputs();        let data = [];        let editIndex = -1;        document.getElementById('submitBtn').addEventListener('click', submitForm);        document.getElementById('updateBtn').addEventListener('click', updateForm);        function submitForm() {            const formData = getFormData();            data.push(formData);            renderTables();            resetForm();        }        function updateForm() {            if (editIndex !== -1) {                const formData = getFormData();                data[editIndex] = formData;                renderTables();                resetForm();                document.getElementById('submitBtn').style.display = 'inline-block';                document.getElementById('updateBtn').style.display = 'none';                editIndex = -1;            }        }        function getFormData() {            const formData = {                baseName: document.getElementById('baseName').value,                baseType: document.getElementById('baseType').value,                monthYear: document.getElementById('monthYear').value,                personnelName: document.getElementById('personnelName').value,                isProductive: document.getElementById('isProductive').checked,                missionCount: document.getElementById('missionCount').value,                mealCount: document.getElementById('mealCount').value,                notes: document.getElementById('notes').value            };            shifts.forEach(shift => {                formData[shift.countId] = document.getElementById(shift.countId).value;                formData[shift.dateId] = document.getElementById(shift.dateId).value;            });            additionalItems.forEach(item => {                formData[item.hoursId] = document.getElementById(item.hoursId).value;                formData[item.dateId] = document.getElementById(item.dateId).value;            });            return formData;        }        function renderTables() {            const tableContainer = document.getElementById('tableContainer');            tableContainer.innerHTML = '';            const table1 = createTable1();            const table2 = createTable2();            tableContainer.appendChild(table1);            tableContainer.appendChild(table2);            addDownloadButtons(tableContainer);        }        function createTable1() {            const table = document.createElement('table');            table.id = 'table1';            const headerTitle = `میزان کارکرد پایگاه ${data[0].baseName}، ${data[0].baseType}، ${data[0].monthYear}`;            table.innerHTML = `                <caption>${headerTitle}</caption>                <tr>                    <th>نام پرسنل</th>                    <th>بهره ور</th>                    <th>نوع پایگاه</th>                    <th>نام پایگاه</th>                    <th>ماه و سال</th>                    <th>۲۴ عادی</th>                    <th>۲۴ تعطیل</th>                    <th>لانگ عادی</th>                    <th>لانگ تعطیل</th>                    <th>شب</th>                    <th>مرخصی کامل</th>                    <th>ساعات متفرقه</th>                    <th>مرخصی ساعتی</th>                    <th>تعداد ماموریت</th>                    <th>تعداد وعده غذا</th>                    <th>ملاحظات</th>                    <th>عملیات</th>                </tr>            `;            data.forEach((item, index) => {                const row = table.insertRow();                row.innerHTML = `                    <td>${item.personnelName}</td>                    <td>${item.isProductive ? 'بله' : 'خیر'}</td>                    <td>${item.baseType}</td>                    <td>${item.baseName}</td>                    <td>${item.monthYear}</td>                    <td>${item.shift24Normal}</td>                    <td>${item.shift24Holiday}</td>                    <td>${item.shiftLongNormal}</td>                    <td>${item.shiftLongHoliday}</td>                    <td>${item.shiftNight}</td>                    <td>${item.fullLeave}</td>                    <td>${item.miscHours}</td>                    <td>${item.hourlyLeave}</td>                    <td>${item.missionCount}</td>                    <td>${item.mealCount}</td>                    <td>${item.notes}</td>                    <td>                        <button onclick="editRow(${index})">ویرایش</button>                        <button onclick="deleteRow(${index})">حذف</button>                    </td>                `;            });            return table;        }        function createTable2() {            const table = document.createElement('table');            table.id = 'table2';            table.innerHTML = `                <tr>                    <th>نام پرسنل</th>                    <th>نام پایگاه</th>                    <th>بهره ور</th>                    <th>تاریخ ۲۴ عادی</th>                    <th>تاریخ ۲۴ تعطیل</th>                    <th>تاریخ لانگ عادی</th>                    <th>تاریخ لانگ تعطیل</th>                    <th>تاریخ شب</th>                    <th>تاریخ مرخصی کامل</th>                    <th>تاریخ ساعات متفرقه</th>                    <th>تاریخ مرخصی ساعتی</th>                </tr>            `;            data.forEach(item => {                const row = table.insertRow();                row.innerHTML = `                    <td>${item.personnelName}</td>                    <td>${item.baseName}</td>                    <td>${item.isProductive ? 'بله' : 'خیر'}</td>                    <td>${item.shift24NormalDate}</td>                    <td>${item.shift24HolidayDate}</td>                    <td>${item.shiftLongNormalDate}</td>                    <td>${item.shiftLongHolidayDate}</td>                    <td>${item.shiftNightDate}</td>                    <td>${item.fullLeaveDate}</td>                    <td>${item.miscHoursDate}</td>                    <td>${item.hourlyLeaveDate}</td>                `;            });            return table;        }        function addDownloadButtons(container) {    const downloadImageBtn = document.createElement('button');    downloadImageBtn.textContent = 'دانلود تصویر هر دو جدول';    downloadImageBtn.onclick = downloadBothTablesImage;    container.appendChild(downloadImageBtn);    const downloadCsvBtn = document.createElement('button');    downloadCsvBtn.textContent = 'دانلود CSV هر دو جدول';    downloadCsvBtn.onclick = downloadBothTablesCsv;    container.appendChild(downloadCsvBtn);}function downloadBothTablesImage() {    const tables = document.querySelectorAll('table');    html2canvas(document.getElementById('tableContainer')).then(canvas => {        const link = document.createElement('a');        link.download = 'both_tables.png';        link.href = canvas.toDataURL();        link.click();    });}function downloadBothTablesCsv() {    const tables = document.querySelectorAll('table');    let csv = '\uFEFF'; // BOM for UTF-8    tables.forEach((table, index) => {        // Add table caption (header) to CSV        if (table.caption) {            csv += table.caption.textContent + '\n';        } else {            csv += `Table ${index + 1}\n`;        }        // Add column headers        const headers = table.querySelectorAll('th');        csv += Array.from(headers).map(header => `"${header.textContent}"`).join(',') + '\n';        // Add rows        const rows = table.querySelectorAll('tr');        rows.forEach(row => {            const cells = row.querySelectorAll('td');            if (cells.length > 0) {                csv += Array.from(cells).map(cell => `"${cell.textContent}"`).join(',') + '\n';            }        });        csv += '\n'; // Add a blank line between tables    });    const blob = new Blob([csv], { type: 'text/csv;charset=utf-8;' });    const link = document.createElement('a');    link.href = URL.createObjectURL(blob);    link.download = 'both_tables.csv';    link.click();}        function editRow(index) {            editIndex = index;            const item = data[index];            document.getElementById('baseName').value = item.baseName;            document.getElementById('baseType').value = item.baseType;            document.getElementById('monthYear').value = item.monthYear;            document.getElementById('personnelName').value = item.personnelName;            document.getElementById('isProductive').checked = item.isProductive;            document.getElementById('missionCount').value = item.missionCount;            document.getElementById('mealCount').value = item.mealCount;            document.getElementById('notes').value = item.notes;            shifts.forEach(shift => {                document.getElementById(shift.countId).value = item[shift.countId];                document.getElementById(shift.dateId).value = item[shift.dateId];            });            additionalItems.forEach(item => {                document.getElementById(item.hoursId).value = item[item.hoursId];                document.getElementById(item.dateId).value = item[item.dateId];            });            document.getElementById('submitBtn').style.display = 'none';            document.getElementById('updateBtn').style.display = 'inline-block';        }        function deleteRow(index) {            data.splice(index, 1);            renderTables();        }        function resetForm() {            document.getElementById('personnelName').value = '';            document.getElementById('isProductive').checked = false;            document.getElementById('missionCount').value = '';            document.getElementById('mealCount').value = '';            document.getElementById('notes').value = '';            shifts.forEach(shift => {                document.getElementById(shift.countId).value = '';                document.getElementById(shift.dateId).value = '';            });            additionalItems.forEach(item => {                document.getElementById(item.hoursId).value = '';                document.getElementById(item.dateId).value = '';            });        }        // Initialize the form with the first submission        document.getElementById('submitBtn').addEventListener('click', function() {            if (data.length === 0) {                const baseInfo = {                    baseName: document.getElementById('baseName').value,                    baseType: document.getElementById('baseType').value,                    monthYear: document.getElementById('monthYear').value                };                localStorage.setItem('baseInfo', JSON.stringify(baseInfo));            }        });        // Load saved base info if exists        const savedBaseInfo = localStorage.getItem('baseInfo');        if (savedBaseInfo) {            const baseInfo = JSON.parse(savedBaseInfo);            document.getElementById('baseName').value = baseInfo.baseName;            document.getElementById('baseType').value = baseInfo.baseType;            document.getElementById('monthYear').value = baseInfo.monthYear;                        document.getElementById('baseName').disabled = true;            document.getElementById('baseType').disabled = true;            document.getElementById('monthYear').disabled = true;        }    </script></body></html>